---
version: '3.6'

services:
  adminer:
    depends_on:
    - db
    image: adminer
    ports:
    - 8081:8080/tcp

  db:
    environment:
    - MYSQL_DATABASE=nca_sulu
    - MYSQL_PASSWORD=nca_sulu
    - MYSQL_ROOT_PASSWORD=aex5iejaeTh3ongo4chu
    - MYSQL_USER=nca_sulu
    - TZ=Europe/Berlin
    image: mariadb
    ports:
    - 33006:3306/tcp
    volumes:
    - './db-live:/var/lib/mysql'
    - './db-init:/docker-entrypoint-initdb.d'
    restart: always

  web:
    build:
      context: .
      target: webserver
    depends_on:
    - db
    environment:
    - APP_ENV=dev
    - APP_SECRET=a59875c7c3b45ab6b56f3a3a45af10e4
    - DATABASE_URL=mysql://nca_sulu:nca_sulu@db:3306/nca_sulu
    - MAIL_URL=null://localhost
    - SULU_ADMIN_EMAIL=
    - GOOGLE_API_KEY=AIzaSyCDyn1yCKlutlT5dDkLFavE4iK3FOidL7I
    volumes:
      - ./uploads:/var/www/html/var/uploads
    ports:
    - 8080:80/tcp
    restart: always
    env_file: .env
